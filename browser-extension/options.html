<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Kiosk Browser Command â€“ Settings</title>
  <link rel="stylesheet" href="options.css">
</head>
<body>
  <div class="page">
    <aside class="sidebar">
      <div class="sidebar-logo">âŒ¨ KBC</div>
      <nav class="sidebar-nav">
        <a href="#settings" class="nav-item active" data-section="settings">Connection</a>
        <a href="#scripts"  class="nav-item"         data-section="scripts">Scripts</a>
        <a href="#docs"     class="nav-item"         data-section="docs">API Docs</a>
      </nav>
    </aside>

    <main class="main">

      <!-- â”€â”€ Connection â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
      <section id="section-settings" class="section active">
        <h2 class="section-title">Kiosk Manager Connection</h2>

        <div class="card">
          <div class="form-group">
            <label for="kioskManagerUrl">Kiosk Manager URL</label>
            <input type="url" id="kioskManagerUrl"
              placeholder="https://kiosk-manager.example.com">
            <p class="hint">URL of the Django service, without a trailing slash.</p>
          </div>

          <div class="form-row">
            <div class="form-group" style="flex:1">
              <label for="pollInterval">Poll interval (minutes)</label>
              <input type="number" id="pollInterval" min="1" max="60" value="1" style="width:80px">
            </div>
            <div class="form-group" style="display:flex;align-items:flex-end;padding-bottom:4px">
              <label class="toggle-label">
                <input type="checkbox" id="kioskEnabled" checked>
                <span>Polling enabled</span>
              </label>
            </div>
          </div>

          <div class="form-group">
            <label>Browser ID (read-only)</label>
            <div class="browser-id-row">
              <input type="text" id="browserIdDisplay" readonly class="mono">
              <button id="copyBrowserId" class="btn btn-ghost btn-sm">Copy</button>
            </div>
            <p class="hint">This ID identifies this browser in the Kiosk Manager.</p>
          </div>

          <div class="form-actions">
            <button id="saveSettingsBtn" class="btn btn-primary">Save</button>
            <button id="testConnectionBtn" class="btn btn-ghost">Test connection</button>
            <span id="settingsSaveStatus" class="save-status"></span>
          </div>
        </div>
      </section>

      <!-- â”€â”€ Scripts â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
      <section id="section-scripts" class="section">
        <h2 class="section-title">Automation Scripts</h2>

        <div class="scripts-layout">
          <!-- Script list (left) -->
          <div class="scripts-list-panel">
            <div class="list-toolbar">
              <button id="newScriptBtn" class="btn btn-primary btn-sm">+ New</button>
              <div class="list-tools">
                <button id="exportBtn"  class="btn btn-ghost btn-sm">â†‘ Export</button>
                <label  class="btn btn-ghost btn-sm">â†“ Import
                  <input type="file" id="importFile" accept=".json" style="display:none">
                </label>
              </div>
            </div>
            <ul id="scriptsList" class="scripts-list"></ul>
          </div>

          <!-- Editor (right) -->
          <div class="editor-panel">
            <div id="editorPlaceholder" class="editor-placeholder">
              <p>ðŸ‘ˆ Select a script or create a new one</p>
            </div>

            <div id="editorForm" style="display:none" class="editor-form">
              <div class="editor-header">
                <input type="text" id="scriptName" class="script-name-input"
                  placeholder="Script name">
                <div class="editor-header-actions">
                  <button id="duplicateBtn" class="btn btn-ghost btn-sm">Duplicate</button>
                  <button id="deleteBtn"    class="btn btn-danger btn-sm">Delete</button>
                </div>
              </div>

              <div class="form-row">
                <div class="form-group" style="flex:1">
                  <label for="scriptUrlPattern">URL pattern <span class="badge">auto-trigger</span></label>
                  <input type="text" id="scriptUrlPattern"
                    placeholder="*://login.microsoftonline.com/* (empty = manual only)">
                  <p class="hint">Wildcards with <code>*</code> supported. If the URL matches, the script runs automatically on page load.</p>
                </div>
                <div class="form-group" style="width:120px;display:flex;align-items:flex-end;padding-bottom:4px">
                  <label class="toggle-label">
                    <input type="checkbox" id="scriptEnabled" checked>
                    <span>Enabled</span>
                  </label>
                </div>
              </div>

              <div class="form-group">
                <div class="editor-label-row">
                  <label for="scriptContent">Script</label>
                  <div class="snippet-bar">
                    <span class="snippet-label">Snippets:</span>
                    <button class="snippet-btn" data-snippet="powerbi">PowerBI Login</button>
                    <button class="snippet-btn" data-snippet="get-type">get + type</button>
                    <button class="snippet-btn" data-snippet="get-click">get + click</button>
                    <button class="snippet-btn" data-snippet="wait">wait</button>
                    <button class="snippet-btn" data-snippet="waitForUrl">waitForUrl</button>
                  </div>
                </div>
                <textarea id="scriptContent" class="script-editor" spellcheck="false"
                  placeholder="// cy.get('#email').type('user@example.com');&#10;// cy.get('[type=submit]').click();"></textarea>
              </div>

              <div class="editor-footer">
                <button id="saveScriptBtn"  class="btn btn-primary">ðŸ’¾ Save</button>
                <button id="runScriptBtn"   class="btn btn-ghost">â–¶ Run on active page</button>
                <span id="scriptSaveStatus" class="save-status"></span>
              </div>
            </div>
          </div>
        </div>
      </section>

      <!-- â”€â”€ API Docs â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
      <section id="section-docs" class="section">
        <h2 class="section-title">Available Commands (Cypress-like API)</h2>

        <div class="card">
          <p class="docs-intro">
            Scripts are executed with <code>cy</code> as the available object.
            Commands are added to a queue and executed sequentially.
          </p>

          <h3>Navigation</h3>
          <table class="api-table">
            <thead><tr><th>Command</th><th>Description</th><th>Example</th></tr></thead>
            <tbody>
              <tr><td><code>cy.visit(url)</code></td><td>Navigate to URL</td><td><code>cy.visit('https://powerbi.com')</code></td></tr>
              <tr><td><code>cy.waitForUrl(text)</code></td><td>Wait until URL contains text</td><td><code>cy.waitForUrl('app.powerbi')</code></td></tr>
            </tbody>
          </table>

          <h3>Element Selection</h3>
          <table class="api-table">
            <thead><tr><th>Command</th><th>Description</th><th>Example</th></tr></thead>
            <tbody>
              <tr><td><code>cy.get(selector)</code></td><td>Find element by CSS selector (waits)</td><td><code>cy.get('#email')</code></td></tr>
              <tr><td><code>cy.contains(text)</code></td><td>Find element by visible text</td><td><code>cy.contains('Sign in')</code></td></tr>
            </tbody>
          </table>

          <h3>Actions (chained after <code>cy.get()</code>)</h3>
          <table class="api-table">
            <thead><tr><th>Command</th><th>Description</th><th>Example</th></tr></thead>
            <tbody>
              <tr><td><code>.click()</code></td><td>Click the element</td><td><code>cy.get('button').click()</code></td></tr>
              <tr><td><code>.type(text)</code></td><td>Type text (React/Angular compatible)</td><td><code>cy.get('input').type('hello')</code></td></tr>
              <tr><td><code>.clear()</code></td><td>Clear an input field</td><td><code>cy.get('input').clear()</code></td></tr>
              <tr><td><code>.pressEnter()</code></td><td>Press the Enter key</td><td><code>cy.get('input').pressEnter()</code></td></tr>
              <tr><td><code>.autofill()</code></td><td>Trigger browser autofill + notify React</td><td><code>cy.get('input').autofill()</code></td></tr>
              <tr><td><code>.select(value)</code></td><td>Set a select dropdown value</td><td><code>cy.get('select').select('en')</code></td></tr>
              <tr><td><code>.check(bool)</code></td><td>Check or uncheck a checkbox</td><td><code>cy.get('[type=checkbox]').check(true)</code></td></tr>
            </tbody>
          </table>

          <h3>Waiting</h3>
          <table class="api-table">
            <thead><tr><th>Command</th><th>Description</th><th>Example</th></tr></thead>
            <tbody>
              <tr><td><code>cy.wait(ms)</code></td><td>Fixed wait in milliseconds</td><td><code>cy.wait(2000)</code></td></tr>
              <tr><td><code>cy.waitForUrl(pattern)</code></td><td>Wait until URL matches pattern</td><td><code>cy.waitForUrl('login.live.com')</code></td></tr>
              <tr><td><code>.waitForHidden(sel)</code></td><td>Wait until element disappears</td><td><code>cy.waitForHidden('.spinner')</code></td></tr>
            </tbody>
          </table>

          <h3>Assertions &amp; Logging</h3>
          <table class="api-table">
            <thead><tr><th>Command</th><th>Description</th></tr></thead>
            <tbody>
              <tr><td><code>.should('exist')</code></td><td>Element must be present</td></tr>
              <tr><td><code>.should('be.visible')</code></td><td>Element must be visible</td></tr>
              <tr><td><code>.should('have.value', v)</code></td><td>Input must have value</td></tr>
              <tr><td><code>.should('contain', text)</code></td><td>Element must contain text</td></tr>
              <tr><td><code>cy.log(msg)</code></td><td>Print message to browser console</td></tr>
            </tbody>
          </table>

          <h3>Example: PowerBI Login</h3>
          <pre class="code-block">// Script for URL pattern: *://login.microsoftonline.com/*
// Uses browser-saved credentials (no passwords in the script)

cy.log("Starting Microsoft login...");

cy.wait(1000); // wait for browser autofill
cy.get('#idSIButton9').click();  // Next
cy.wait(2000);
cy.get('#idSIButton9').click();  // Sign in
cy.wait(3000);
cy.get('#idBtn_Back').click();   // Stay signed in? â†’ No

cy.log("Login complete âœ“");</pre>
        </div>
      </section>

    </main>
  </div>

  <script src="options.js"></script>
</body>
</html>
